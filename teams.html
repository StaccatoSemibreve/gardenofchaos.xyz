<!DOCTYPE html>
<html lang="">
	<head>
		<meta charset="utf-8">
		<title>Garden of Chaos: Team Battle Tool</title>
		<link rel="icon" type="image/png" href="FSgardenOfChao-196x196.png" sizes="196x196">
		<style>
			p, h1, form {
				font-family: sans-serif;
				color: #daba69;
				line-height: 30px;
			}
			input, button, select {
				font-family: sans-serif;
				color: #daba69;
				height: 40px;
				background-color: #000000;
				padding: 6px 8px;
				border-radius: 10px;
			}
			hr {
				border: 1px solid #daba69;
			}
			
			@media only screen and (min-width:850px) {
				div#center-div {
					max-width: 800px;
					margin: auto;
				}
				body {
					background: linear-gradient(90deg, #0f0d0c, #0f0d0c calc(50% - 425px), #1e1b19 calc(50% - 425px), #1e1b19 calc(50% + 425px), #0f0d0c calc(50% + 425px));
				}
			}
			@media only screen and (min-width:650px) and (max-width:850px) {
				div#center-div {
					max-width: 600px;
					margin: auto;
				}
				body {
					background: linear-gradient(90deg, #0f0d0c, #0f0d0c calc(50% - 325px), #1e1b19 calc(50% - 325px), #1e1b19 calc(50% + 325px), #0f0d0c calc(50% + 325px));
				}
			}
			@media only screen and (min-width:500px) and (max-width:650px) {
				div#center-div {
					max-width: 450px;
					margin: auto;
				}
				body {
					background: linear-gradient(90deg, #0f0d0c, #0f0d0c calc(50% - 250px), #1e1b19 calc(50% - 250px), #1e1b19 calc(50% + 250px), #0f0d0c calc(50% + 250px));
				}
			}
			@media only screen and (min-width:350px) and (max-width:500px) {
				div#center-div {
					max-width: 300px;
					margin: auto;
				}
				body {
					background: linear-gradient(90deg, #0f0d0c, #0f0d0c calc(50% - 175px), #1e1b19 calc(50% - 175px), #1e1b19 calc(50% + 175px), #0f0d0c calc(50% + 175px));
				}
			}
			@media only screen and (max-width:350px) {
				div#center-div {
					max-width: 90%;
					margin: auto;
				}
				body {
					background-color: #1e1b19;
				}
			}
			@media only screen and (min-width:650px) {
				body {
					display: grid;
					grid-template-rows: 150px;
					grid-template-areas:	"navbar"
											"main";
					max-width: 2000px;
					margin: auto;
				}
				main {
					grid-area: main;
					max-width: 2000px;
					margin: auto;
				}
				
				.navbar-div {
					display: grid;
					background-color: black;
					width: 600px;
					grid-template-columns: 150px 150px 150px 150px;
					grid-template-rows: 60px 59px;
					border-radius: 10px;
					align-content: center center;
					grid-template-areas:	"home	signup		discord	stream"
											"rules	rulesets	formats	resources";
					margin: auto;
					border: 1px solid #daba69;
				}
				.navbar-item {
					width: 148px;
					height: 30px;
					padding-top: 15px;
					text-align: center;
					text-decoration: none;
					line-height: 30px;
					font-weight: bold;
					margin: auto;
					font-family: sans-serif;
					color: #daba69;
				}
				span.navbar-item {
					position: relative;
					top: -10px;
				}
				.navbar-item-container {
					width: 150px;
					height: 59px;
					position: relative;
					border-top: 1px solid #daba69;
					border-left: 1px solid #daba69;
					position: relative;
					top: -1px;
					left: -1px;
				}
				.navbar-icon {
					width: 45px;
					height: 45px;
					position: relative;
					left: -5px;
					top: 8px;
				}
				.navbar-icon#goc-logo {
					left: -10px;
				}
				.navbar-item-container#navbar-home {
					border-radius: 10px 0px 0px 0px;
				}
				.navbar-item-container#navbar-stream {
					border-radius: 0px 10px 0px 0px;
				}
				.navbar-item-container#navbar-resources {
					border-radius: 0px 0px 10px 0px;
				}
				.navbar-item-container#navbar-rules {
					border-radius: 0px 0px 0px 10px;
				}
				.navbar-item-container#navbar-commentators {
					display: none;
				}
			}
			
			@media only screen and (min-width:500px) and (max-width: 650px) {
				body {
					display: grid;
					grid-template-rows: 210px;
					grid-template-areas:	"navbar"
											"main";
					max-width: 2000px;
					margin: auto;
				}
				main {
					grid-area: main;
					max-width: 2000px;
					margin: auto;
				}
				
				.navbar-div {
					display: grid;
					background-color: black;
					width: 450px;
					grid-template-columns: 150px 150px 150px;
					grid-template-rows: 60px 60px 59px;
					border-radius: 10px;
					align-content: center center;
					grid-template-areas:	"home	rulesets	resources"
											"rules	formats		commentators"
											"signup	discord		stream";
					margin: auto;
					border: 1px solid #daba69;
				}
				.navbar-item {
					width: 150px;
					height: 30px;
					padding-top: 15px;
					text-align: center;
					text-decoration: none;
					line-height: 30px;
					font-weight: bold;
					margin: auto;
					font-family: sans-serif;
					color: #daba69;
				}
				span.navbar-item {
					position: relative;
					top: -10px;
				}
				span.navbar-item-no-logo {
					position: relative;
					top: 20px;
				}
				.navbar-item-container {
					width: 150px;
					height: 59px;
					position: relative;
					border-top: 1px solid #daba69;
					border-left: 1px solid #daba69;
					position: relative;
					top: -1px;
					left: -1px;
				}
				.navbar-icon {
					width: 45px;
					height: 45px;
					position: relative;
					left: -5px;
					top: 8px;
				}
				.navbar-icon#goc-logo {
					left: -10px;
				}
				.navbar-item-container#navbar-home {
					border-radius: 10px 0px 0px 0px;
				}
				.navbar-item-container#navbar-resources {
					border-radius: 0px 10px 0px 0px;
				}
				.navbar-item-container#navbar-stream {
					border-radius: 0px 0px 10px 0px;
				}
				.navbar-item-container#navbar-signup {
					border-radius: 0px 0px 0px 10px;
				}
				.navbar-item-container#navbar-commentators {
					display: block;
				}
			}
			
			@media only screen and (min-width:350px) and (max-width: 500px) {
				body {
					display: grid;
					grid-template-rows: 270px;
					grid-template-areas:	"navbar"
											"main";
					max-width: 2000px;
					margin: auto;
				}
				main {
					grid-area: main;
					max-width: 2000px;
					margin: auto;
				}
				
				.navbar-div {
					display: grid;
					background-color: black;
					width: 300px;
					grid-template-columns: 150px 150px;
					grid-template-rows: 60px 60px 60px 60px;
					border-radius: 10px;
					align-content: center center;
					grid-template-areas:	"home	rulesets"
											"rules	formats"
											"signup	discord"
											"stream resources";
					margin: auto;
					border: 1px solid #daba69;
				}
				.navbar-item {
					width: 148px;
					height: 30px;
					padding-top: 15px;
					text-align: center;
					text-decoration: none;
					line-height: 30px;
					font-weight: bold;
					margin: auto;
					font-family: sans-serif;
					color: #daba69;
				}
				span.navbar-item {
					position: relative;
					top: -10px;
				}
				span.navbar-item-no-logo {
					position: relative;
					top: 20px;
				}
				.navbar-item-container {
					width: 150px;
					height: 60px;
					position: relative;
					border-top: 1px solid #daba69;
					border-left: 1px solid #daba69;
					position: relative;
					top: -1px;
					left: -1px;
				}
				.navbar-icon {
					width: 45px;
					height: 45px;
					position: relative;
					left: -5px;
					top: 8px;
				}
				.navbar-icon#goc-logo {
					left: -10px;
				}
				.navbar-item-container#navbar-home {
					border-radius: 10px 0px 0px 0px;
				}
				.navbar-item-container#navbar-rulesets {
					border-radius: 0px 10px 0px 0px;
				}
				.navbar-item-container#navbar-resources {
					border-radius: 0px 0px 10px 0px;
				}
				.navbar-item-container#navbar-stream {
					border-radius: 0px 0px 0px 10px;
				}
				.navbar-item-container#navbar-commentators {
					display: none;
				}
			}
			
			@media only screen and (max-width: 350px) {
				body {
					display: grid;
					grid-template-areas: "main";
					max-width: 2000px;
					margin: auto;
				}
				main {
					grid-area: main;
					max-width: 2000px;
					margin: auto;
				}
				
				.navbar-div {
					display: none;
				}
			}
			
			.navbar-item-container:hover {
				background-color: #100e0d;
			}
			.navbar-item-container#navbar-home {
				grid-area: home;
			}
			.navbar-item-container#navbar-rules {
				grid-area: rules;
			}
			.navbar-item-container#navbar-rulesets {
				grid-area: rulesets;
			}
			.navbar-item-container#navbar-formats {
				grid-area: formats;
			}
			.navbar-item-container#navbar-signup {
				grid-area: signup;
			}
			.navbar-item-container#navbar-discord {
				grid-area: discord;
			}
			.navbar-item-container#navbar-stream {
				grid-area: stream;
			}
			.navbar-item-container#navbar-resources {
				grid-area: resources;
			}
			.navbar-item-container#navbar-commentators {
				grid-area: commentators;
			}
			.navbar-icon#goc-logo {
				grid-area: home;
			}
			.navbar-icon#discord-logo {
				grid-area: discord;
			}
		</style>
	</head>
	<body>
		<header class="navbar-div">
			<div class="navbar-item-container" id="navbar-home"><a href="/" class="navbar-item" title="Return unto the home page!!!"><div class="navbar-item-container" id="navbar-home"><image id="goc-logo" class="navbar-icon" src="media/logo-optimised.svg" alt="A logo of a happy chao in a circle, in the colours of the Fantasy Strike logo."><span class="navbar-item">Home</span></div></a></div>
			<div class="navbar-item-container" id="navbar-rules"><a href="rules" class="navbar-item" title="View the tournament rules!"><div class="navbar-item-container" id="navbar-rules"><div class="navbar-item">Rules</div></div></a></div>
			<div class="navbar-item-container" id="navbar-rulesets"><a href="rulesets" class="navbar-item" title="View the silly rulesets you can choose to play under!"><div class="navbar-item-container" id="navbar-rulesets"><div class="navbar-item">Rulesets</div></div></a></div>
			<div class="navbar-item-container" id="navbar-formats"><a href="styles" class="navbar-item" title="View potential future tournament formats!"><div class="navbar-item-container" id="navbar-formats"><div class="navbar-item">Formats</div></div></a></div>
			<div class="navbar-item-container" id="navbar-signup"><a href="bracket" class="navbar-item" title="Join this week's tournament bracket!"><div class="navbar-item-container" id="navbar-signup"><image id="discord-logo" class="navbar-icon" src="media/challonge.svg" alt="The challonge logo in a circle, in the colours of the Fantasy Strike logo."><span class="navbar-item">Signup</span></div></a></div>
			<div class="navbar-item-container" id="navbar-discord"><a href="https://discord.gg/abWADS7" class="navbar-item" title="Join the discord server!"><div class="navbar-item-container" id="navbar-discord"><image id="discord-logo" class="navbar-icon" src="media/discord.svg" alt="The Discord logo in a circle, in the colours of the Fantasy Strike logo."><span class="navbar-item">Discord</span></div></a></div>
			<div class="navbar-item-container" id="navbar-stream"><a href="stream" class="navbar-item" title="Watch the tournament live!"><div class="navbar-item-container" id="navbar-stream"><image id="twitch-logo" class="navbar-icon" src="media/twitch.svg" alt="The Twitch logo in a circle, in the colours of the Fantasy Strike logo."><span class="navbar-item">Stream</span></div></a></div>
			<div class="navbar-item-container" id="navbar-resources"><a href="resources" class="navbar-item" title="Read up on a bunch of useful Fantasy Strike knowledge!"><div class="navbar-item-container" id="navbar-resources"><div class="navbar-item">Resources</div></div></a></div>
			<div class="navbar-item-container" id="navbar-commentators"><a href="commentators" class="navbar-item" title="See who our commentators are and what else they do!"><div class="navbar-item-container" id="navbar-commentators"><div class="navbar-item">Commentators</div></div></a></div>
		</header>
    <main>
		<div id="center-div">
			<h1>The Garden of Chaos</h1>
					<form id="seeding" onsubmit 'return false'>
						Seed (0 or No Submit = Random Seed): 
						<input type="number" id="seed" placeholder="Randomiser Seed" value=0 min=0 />
						<input type="button" value="Randomise Seed" onclick='randomiseSeed()'/>
						<input type="button" value="Submit Seed" onclick='initSeed()'/>
					</form>
					<div id="teams" style="display:none">
						<div id="team1div">
						<p>Team 1:</p>
						<form id="team1" onsubmit='return false'>
							<input type="number" id="team1Size" placeholder="Team Size" min="1"/>
							<input type="button" value="Submit Team 1 Size" onclick="setTeam1Size()"/>
							or
							<select id="team1Presets">
								<option value=0>Full Cast</option>
								<option value=1>Zoners</option>
								<option value=2>Rushdowns</option>
								<option value=3>Grapplers</option>
								<option value=4>Wildcards</option>
								<option value="random">Random Team</option>
								<option value="5">The Left Side</option>
								<option value="6">The Right Side</option>
							</select>
							<input type="button" value="Submit Team 1 Preset" onclick="setTeam1Preset()"/>
						</form>
						</div>

						<br>

						<div id="team2div">
						<p>Team 2:</p>
						<form id="team2" onsubmit='return false'>
							<input type="number" id="team2Size" placeholder="Team Size" min="0"/>
							<input type="button" value="Submit Team 2 Size" onclick="setTeam2Size()"/>
							or
							<select id="team2Presets">
								<option value=0>Full Cast</option>
								<option value=1>Zoners</option>
								<option value=2>Rushdowns</option>
								<option value=3>Grapplers</option>
								<option value=4>Wildcards</option>
								<option value="random">Random Team</option>
								<option value="5">The Left Side</option>
								<option value="6">The Right Side</option>
							</select>
							<input type="button" value="Submit Team 2 Preset" onclick="setTeam2Preset()"/>
						</form>
						</div>
						
						<br>
						<div id="team1Remaining">
						</div>
						
						<br>
						<div id="team2Remaining">
						</div>
					</div>
		</div>
    </main>
		<footer></footer>
	</body>
	<script>
        var charSelect = '<option value="Grave">Grave</option><option value="Jaina">Jaina</option><option value="Geiger">Geiger</option><option value="Argagarg">Argagarg</option><option value="Setsuki">Setsuki</option><option value="Valerie">Valerie</option><option value="Rook">Rook</option><option value="Midori">Midori</option><option value="Lum">Lum</option><option value="Degrey">Degrey</option><option value="Quince">Quince</option><option value="Onimaru">Onimaru</option><option value="Custom">Custom</option></select>';
        var presets = [["Grave", "Jaina", "Geiger", "Argagarg", "Setsuki", "Valerie", "Rook", "Midori", "Lum", "Degrey", "Quince", "Onimaru"], ["Grave", "Jaina", "Geiger", "Argagarg"], ["Setsuki", "Valerie"], ["Rook", "Midori"], ["Lum", "Degrey", "Quince", "Onimaru"], ["Grave", "Geiger", "Setsuki", "Rook", "Lum", "Quince"], ["Jaina", "Argagarg", "Valerie", "Midori", "Degrey", "Onimaru"]];

        var seed = 0;
        var submit = false;

        var team1Size = 0;
        var team1 = [];
        var team1Sequence = [];
        var team2Size = 0;
        var team2 = [];
        var team2Sequence = [];
        var match = 0;

        function randomiseSeed() {
            document.getElementById('seed').value = Math.floor(Math.random()*Number.MAX_SAFE_INTEGER);
        }
        function initSeed() {
            seed = document.getElementById('seed').value;
            var seed0 = (seed==0);
            if(seed0)
                seed = Math.floor(Math.random()*Number.MAX_SAFE_INTEGER);
            if(seed0)
                document.getElementById('seeding').outerHTML="<p>Seed: Random (" + seed + ")</p";
            else
                document.getElementById('seeding').outerHTML="<p>Seed: " + seed + "</p>";
            console.log("Seed: "+seed);
            document.getElementById('teams').style="";
        }
        function seededRandom(min, max) {
            max = max || 1;
            min = min || 0;

            seed = (seed * 9301 + 49297) % 233280;
            var rnd = seed / 233280;

            return min + Math.floor(rnd * (max - min));
        }

        function zipped(arr) {
            arr = arr.map(function(e, i) {return [e, i+1];});
        }

        function setTeam1Size() {
            team1Size = document.getElementById('team1Size').value;
            console.log("Team 1 Size: "+team1Size);
            if(team1Size > 0) {
                document.getElementById('team1').innerHTML = '';

                for(var count = 1; count <= team1Size; count++)
                    document.getElementById('team1').innerHTML += '<select id="team1Select'+count+'">'+charSelect;
                document.getElementById('team1').innerHTML += '<input type="button" value="Submit Team 1 Members" onclick="setTeam1Members()"/>';
            }
        }
        function setTeam2Size() {
            team2Size = document.getElementById('team2Size').value;
            console.log("Team 2 Size: "+team2Size);
            if(team2Size > 0) {
                document.getElementById('team2').innerHTML = '';

                for(var count = 1; count <= team2Size; count++)
                    document.getElementById('team2').innerHTML += '<select id="team2Select'+count+'">'+charSelect;
                document.getElementById('team2').innerHTML += '<input type="button" value="Submit Team 2 Members" onclick="setTeam2Members()"/>';
            }
        }

        function setTeam1Members() {
            for(var count = 1; count <= team1Size; count++)
                team1 = team1.concat(document.getElementById('team1Select'+count).value);
            document.getElementById('team1').outerHTML = "<p>"+team1.join(", ")+"</p>";
            team1 = team1.map(function(e, i) {return [e, i+1];});
            console.log("Team 1: "+team1.map(function(e) {return e[0]}).join(", "));
            if(submit) {play();}
            submit = true;
        }
        function setTeam2Members() {
            for(var count = 1; count <= team2Size; count++)
                team2 = team2.concat(document.getElementById('team2Select'+count).value);
            document.getElementById('team2').outerHTML = "<p>"+team2.join(", ")+"</p>";
            team2 = team2.map(function(e, i) {return [e, i+1];});
            console.log("Team 2: "+team2.map(function(e) {return e[0]}).join(", "));
            if(submit) {play();}
            submit = true;
        }

        function setTeam1Preset() {
            var preset = document.getElementById('team1Presets').value;
            console.log("Team 1 Preset: " + preset);
            if(preset == "random") {
                team1 = presets[0].slice(0);
                var size = document.getElementById('team1Size').value;
                if(size == 0)
                size = seededRandom(1, team1.length+1);
                while(team1.length < size)
                    team1 = team1.concat(team1.slice(0));
                while(team1.length > size)
                    team1.splice(seededRandom(0, team1.length), 1);
                team1 = team1.map(function(e, i) {return [e, i+1];});
            }
            else {
                team1 = presets[preset].map(function(e, i) {return [e, i+1];});
            }

            team1Size = team1.length;
            console.log("Team 1: "+team1.map(function(e) {return e[0]}).join(", "));
            document.getElementById('team1').outerHTML = "<p>"+team1.map(function(e) {return e[0]}).join(", ")+"</p>";
            if(submit) {play();}
            submit = true;
        }
        function setTeam2Preset() {
            var preset = document.getElementById('team2Presets').value;
            console.log("Team 2 Preset: " + preset);
            if(preset == "random") {
                team2 = presets[0].slice(0);
                var size = document.getElementById('team2Size').value;
                if(size == 0)
                size = seededRandom(1, team2.length+1);
                while(team2.length < size)
                    team2 = team2.concat(team2.slice(0));
                while(team2.length > size)
                    team2.splice(seededRandom(0, team2.length), 1);
                team2 = team2.map(function(e, i) {return [e, i+1];});
            }
            else {
                team2 = presets[preset].map(function(e, i) {return [e, i+1];});
            }

            team2Size = team2.length;
            console.log("Team 2: "+team2.map(function(e) {return e[0]}).join(", "));
            document.getElementById('team2').outerHTML = "<p>"+team2.map(function(e) {return e[0]}).join(", ")+"</p>";
            if(submit) {play();}
            submit = true;
        }

        function shuffle(a) {
            var j, x, i;
            for (i = a.length - 1; i > 0; i--) {
                j = seededRandom(0, i);
                x = a[i];
                a[i] = a[j];
                a[j] = x;
            }
            return a;
        }
        function play() {
            console.log("Match " + match + ": " + team1Sequence.map(function(e) {return e[0]}).join(", "));
            console.log("Match " + match + ": " + team2Sequence.map(function(e) {return e[0]}).join(", "));
            if(match == 0) {
                while(team1Sequence.length < team1Size*team2Size)
                    team1Sequence = team1Sequence.concat(shuffle(team1.slice(0)));
                while(team2Sequence.length < team1Size*team2Size)
                    team2Sequence = team2Sequence.concat(shuffle(team2.slice(0)));
                console.log("Initial: " + team1Sequence.map(function(e) {return e[0]}).join(", "));
                console.log("Initial: " + team2Sequence.map(function(e) {return e[0]}).join(", "));
            }

            if(team1Sequence.length == 0)
                document.getElementById('teams').innerHTML += '<hr><br><p>Team 1 wins the match!!!</p>';
            else if(team2Sequence.length == 0)
                document.getElementById('teams').innerHTML += '<hr><br><p>Team 2 wins the match!!!</p>';
            else {
                match++;

                document.getElementById('teams').innerHTML += '<hr><br><p>Match ' + match + ': Team 1 Member ' + (team1Sequence[0][1]) + ' (' + team1Sequence[0][0] + ') vs Team 2 Member ' + (team2Sequence[0][1]) + ' (' + team2Sequence[0][0] + ')<br>Winner: <select id="match'+match+'Winner"><option value="1">Team 1\'s ' + team1Sequence[0][0] + '</option><option value="2">Team 2\'s ' + team2Sequence[0][0] + '</option></select><input type="button" id="MatchButton" value="Submit Winner" onclick="win()""></p>';
            }
        }

        function win() {
            var winner = document.getElementById("match"+match+"Winner").value;
            console.log("Team "+winner+" wins");
            document.getElementById("MatchButton").outerHTML = "";
            document.getElementById("match"+match+"Winner").outerHTML = "Team "+winner+"<br>";

            if(winner == "1") {
                var char = team1Sequence[0];
                console.log(char+" wins")
                team1Sequence = team1Sequence.filter(member => member != char);
                team2Sequence = team2Sequence.splice(1);
            }
            else {
                var char = team2Sequence[0];
                console.log(char+" wins")
                team1Sequence = team1Sequence.splice(1);
                team2Sequence = team2Sequence.filter(member => member != char);
            }
            play();
        }
	</script>
</html>
